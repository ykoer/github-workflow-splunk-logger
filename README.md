# GitHub Action: Send Workflow Logs to Splunk
This action collects GitHub workflow logs and sends them to a Splunk HTTP Event Collector (HEC).

## Features

- Sends workflow run metadata to Splunk
- Optionally collects and sends individual job logs

## Usage

```yaml
name: CI with Splunk Logging

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@v3

    - name: Build and test
      run: |
        echo "Running build and tests..."
        # Your build commands here

    - name: Send logs to Splunk
      uses: ykoer/github-workflow-splunk-logger@v1
      with:
        splunk_url: ${{ secrets.SPLUNK_URL }}
        splunk_token: ${{ secrets.SPLUNK_HEC_TOKEN }}
```

## Inputs

| Input | Description | Required | Default |
|-------|-------------|----------|---------|
| `splunk_url` | URL of the Splunk HTTP Event Collector (HEC) including the port | Yes | N/A |
| `splunk_token` | Token for Splunk HEC API access | Yes | N/A |
| `github_token` | Token for Github API | Yes | N/A |
| `run_id` | ID of the specific workflow run | No | Current run ID |
| `index` | Splunk index to send the logs to | No | `github_workflows` |
| `source_type` | Splunk source type for the data | No | `github:workflow:logs` |
| `ssl_verify` | Whether to verify SSL certificates when connecting to Splunk | No | `true` |
| `include_job_steps` | Whether to include individual job step logs | No | `true` |
| `timeout` | HTTP request timeout in seconds | No | `30` |
| `max_retries` | Maximum number of retries for failed requests | No | `3` |

## Outputs

This action does not provide any outputs.

## Environment Variables

These environment variables are automatically set by GitHub Actions and are required to fetch workflow logs:

- `GITHUB_API_URL`: The base URL for GitHub’s API. It is used to interact with GitHub’s REST API, such as fetching logs, repository information, or workflow details.
- `GITHUB_REPOSITORY`: The name of the repository where the workflow is running, in the format owner/repo.
- `GITHUB_TOKEN`: A temporary authentication token automatically generated by GitHub Actions. It is used to authenticate API requests to GitHub 
- `GITHUB_REF`: A temporary authentication token automatically generated by GitHub Actions. It is used to authenticate API requests to GitHub 
- `GITHUB_RUN_ID`: A unique identifier for the specific workflow run. It can be used to fetch logs or track workflow execution


## How It Works

The action:
1. Uses the GitHub API to fetch workflow run information
2. Structures the data in a Splunk-friendly format
3. Sends the data to your Splunk instance via HTTP Event Collector
4. Optionally fetches and sends individual job log metadata
5. Implements retry logic for reliability

## Requirements

This action automatically installs:
- Python 3.12
- Required Python packages (`requests`, `PyGithub`)
